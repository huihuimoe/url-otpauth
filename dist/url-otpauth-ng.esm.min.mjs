const t="undefined"!=typeof URL?URL:require("url").URL,e={INVALID_ISSUER:0,INVALID_LABEL:1,INVALID_PROTOCOL:2,MISSING_ACCOUNT_NAME:3,MISSING_COUNTER:4,MISSING_ISSUER:5,MISSING_SECRET_KEY:6,UNKNOWN_OTP:7,INVALID_DIGITS:8,UNKNOWN_ALGORITHM:9};function o(t){this.name="OtpauthInvalidURL",this.errorType=t;for(const o in e)e[o]===t&&(this.message="Given otpauth:// URL is invalid. (Error "+o+")")}o.prototype=new Error,o.prototype.constructor=o;const r=[6,8],n=["SHA1","SHA256","SHA512","MD5"];function i(i){const I=decodeURIComponent,s={};let h;try{h=new t(i)}catch(t){throw t instanceof TypeError?new o(e.INVALID_PROTOCOL):t}if("otpauth:"!==h.protocol)throw new o(e.INVALID_PROTOCOL);h.protocol="http";const N=I((h=new t(h)).host);if("hotp"!==N&&"totp"!==N)throw new o(e.UNKNOWN_OTP);s.type=N;const a=h.pathname.substring(1),S=a.split(~a.indexOf(":")?":":"%3A");let p="",c="";if(1===S.length)c=I(S[0]);else{if(2!==S.length)throw new o(e.INVALID_LABEL);p=I(S[0]),c=I(S[1])}if(c.length<1)throw new o(e.MISSING_ACCOUNT_NAME);if(2===S.length&&p.length<1)throw new o(e.INVALID_ISSUER);s.account=c;const w=h.searchParams;if(!w.has("secret"))throw new o(e.MISSING_SECRET_KEY);if(s.key=w.get("secret"),w.has("issuer")&&p&&w.get("issuer")!==p)throw new o(e.INVALID_ISSUER);if(s.issuer=w.get("issuer")||p,s.digits=6,w.has("digits")){const t=parseInt(w.get("digits"),10);if(-1==r.indexOf(t))throw new o(e.INVALID_DIGITS);s.digits=t}if(w.has("algorithm")){if(-1==n.indexOf(w.get("algorithm")))throw new o(e.UNKNOWN_ALGORITHM);s.algorithm=w.get("algorithm")}if("totp"===N&&w.has("period")&&(s.period=parseFloat(w.get("period"))),"hotp"===N){if(!w.has("counter"))throw new o(e.MISSING_COUNTER);s.counter=parseInt(w.get("counter"),10)}return s}export{e as ErrorType,o as OtpauthInvalidURL,i as parse};
//# sourceMappingURL=url-otpauth-ng.esm.min.mjs.map
