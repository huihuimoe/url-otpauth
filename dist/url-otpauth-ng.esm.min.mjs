const t=0,e=1,o=2,r=3,i=4,n=6,s=7,h=8,a=9;var I={INVALID_ISSUER:t,INVALID_LABEL:e,INVALID_PROTOCOL:o,MISSING_ACCOUNT_NAME:r,MISSING_COUNTER:i,MISSING_ISSUER:5,MISSING_SECRET_KEY:n,UNKNOWN_OTP:s,INVALID_DIGITS:h,UNKNOWN_ALGORITHM:a};class p extends Error{constructor(t){super(),this.name="OtpauthInvalidURL",this.errorType=t;for(const e in I)I[e]===t&&(this.message="Given otpauth:// URL is invalid. (Error "+e+")")}}const c="undefined"!=typeof URL?URL:require("url").URL,g=[6,8],w=["SHA1","SHA256","SHA512","MD5"];function f(I){const f=decodeURIComponent,l={};let u=new c(I);if("otpauth:"!==u.protocol)throw new p(o);u.protocol="http";const d=f((u=new c(u)).host);if("hotp"!==d&&"totp"!==d)throw new p(s);l.type=d;const N=u.pathname.substring(1),S=N.split(~N.indexOf(":")?":":"%3A");let L="",O="";if(1===S.length)O=f(S[0]);else{if(2!==S.length)throw new p(e);L=f(S[0]),O=f(S[1])}if(O.length<1)throw new p(r);if(2===S.length&&L.length<1)throw new p(t);l.account=O;const A=u.searchParams;if(!A.has("secret"))throw new p(n);if(l.key=A.get("secret"),A.has("issuer")&&L&&A.get("issuer")!==L)throw new p(t);if(l.issuer=A.get("issuer")||L,l.digits=6,A.has("digits")){const t=parseInt(A.get("digits"))||0;if(!~g.indexOf(t))throw new p(h);l.digits=t}if(A.has("algorithm")){if(!~w.indexOf(A.get("algorithm")))throw new p(a);l.algorithm=A.get("algorithm")}if("totp"===d&&A.has("period")&&(l.period=parseFloat(A.get("period"))||0),"hotp"===d){if(!A.has("counter"))throw new p(i);l.counter=parseInt(A.get("counter"))||0}return l}export{I as ErrorType,p as OtpauthInvalidURL,f as parse};
//# sourceMappingURL=url-otpauth-ng.esm.min.mjs.map
