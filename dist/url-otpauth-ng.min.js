!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).urlOtpauthNg={})}(this,function(t){"use strict";const e="undefined"!=typeof URL?URL:require("url").URL,o={INVALID_ISSUER:0,INVALID_LABEL:1,INVALID_PROTOCOL:2,MISSING_ACCOUNT_NAME:3,MISSING_COUNTER:4,MISSING_ISSUER:5,MISSING_SECRET_KEY:6,UNKNOWN_OTP:7,INVALID_DIGITS:8,UNKNOWN_ALGORITHM:9};function r(t){this.name="OtpauthInvalidURL",this.errorType=t;for(const e in o)o[e]===t&&(this.message="Given otpauth:// URL is invalid. (Error "+e+")")}r.prototype=new Error,r.prototype.constructor=r;const n=[6,8],i=["SHA1","SHA256","SHA512","MD5"];t.ErrorType=o,t.OtpauthInvalidURL=r,t.parse=function(t){const s=decodeURIComponent,I={};let h;try{h=new e(t)}catch(t){throw t instanceof TypeError?new r(o.INVALID_PROTOCOL):t}if("otpauth:"!==h.protocol)throw new r(o.INVALID_PROTOCOL);h.protocol="http";const p=s((h=new e(h)).host);if("hotp"!==p&&"totp"!==p)throw new r(o.UNKNOWN_OTP);I.type=p;const N=h.pathname.substring(1),a=N.split(~N.indexOf(":")?":":"%3A");let f="",c="";if(1===a.length)c=s(a[0]);else{if(2!==a.length)throw new r(o.INVALID_LABEL);f=s(a[0]),c=s(a[1])}if(c.length<1)throw new r(o.MISSING_ACCOUNT_NAME);if(2===a.length&&f.length<1)throw new r(o.INVALID_ISSUER);I.account=c;const u=h.searchParams;if(!u.has("secret"))throw new r(o.MISSING_SECRET_KEY);if(I.key=u.get("secret"),u.has("issuer")&&f&&u.get("issuer")!==f)throw new r(o.INVALID_ISSUER);if(I.issuer=u.get("issuer")||f,I.digits=6,u.has("digits")){const t=parseInt(u.get("digits"),10);if(-1==n.indexOf(t))throw new r(o.INVALID_DIGITS);I.digits=t}if(u.has("algorithm")){if(-1==i.indexOf(u.get("algorithm")))throw new r(o.UNKNOWN_ALGORITHM);I.algorithm=u.get("algorithm")}if("totp"===p&&u.has("period")&&(I.period=parseFloat(u.get("period"))),"hotp"===p){if(!u.has("counter"))throw new r(o.MISSING_COUNTER);I.counter=parseInt(u.get("counter"),10)}return I},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=url-otpauth-ng.min.js.map
