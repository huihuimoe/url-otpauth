!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).urlOtpauthNg={})}(this,function(t){"use strict";const e=0,o=1,r=2,n=3,i=4,s=6,h=7,a=8,p=9;var f={INVALID_ISSUER:e,INVALID_LABEL:o,INVALID_PROTOCOL:r,MISSING_ACCOUNT_NAME:n,MISSING_COUNTER:i,MISSING_ISSUER:5,MISSING_SECRET_KEY:s,UNKNOWN_OTP:h,INVALID_DIGITS:a,UNKNOWN_ALGORITHM:p};class u extends Error{constructor(t){super(),this.name="OtpauthInvalidURL",this.errorType=t;for(const e in f)f[e]===t&&(this.message="Given otpauth:// URL is invalid. (Error "+e+")")}}const c="undefined"!=typeof URL?URL:require("url").URL,d=[6,8],l=["SHA1","SHA256","SHA512","MD5"];t.ErrorType=f,t.OtpauthInvalidURL=u,t.parse=function(t){const f=decodeURIComponent,I={};let g=new c(t);if("otpauth:"!==g.protocol)throw new u(r);g.protocol="http";const w=f((g=new c(g)).host);if("hotp"!==w&&"totp"!==w)throw new u(h);I.type=w;const N=g.pathname.substring(1),S=N.split(~N.indexOf(":")?":":"%3A");let O="",L="";if(1===S.length)L=f(S[0]);else{if(2!==S.length)throw new u(o);O=f(S[0]),L=f(S[1])}if(L.length<1)throw new u(n);if(2===S.length&&O.length<1)throw new u(e);I.account=L;const _=g.searchParams;if(!_.has("secret"))throw new u(s);if(I.key=_.get("secret"),_.has("issuer")&&O&&_.get("issuer")!==O)throw new u(e);if(I.issuer=_.get("issuer")||O,I.digits=6,_.has("digits")){const t=parseInt(_.get("digits"))||0;if(!~d.indexOf(t))throw new u(a);I.digits=t}if(_.has("algorithm")){if(!~l.indexOf(_.get("algorithm")))throw new u(p);I.algorithm=_.get("algorithm")}if("totp"===w&&_.has("period")&&(I.period=parseFloat(_.get("period"))||0),"hotp"===w){if(!_.has("counter"))throw new u(i);I.counter=parseInt(_.get("counter"))||0}return I},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=url-otpauth-ng.min.js.map
