!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).urlOtpauthNg={})}(this,function(e){"use strict";const t="undefined"!=typeof URL?URL:require("url").URL,o={INVALID_ISSUER:0,INVALID_LABEL:1,INVALID_PROTOCOL:2,MISSING_ACCOUNT_NAME:3,MISSING_COUNTER:4,MISSING_ISSUER:5,MISSING_SECRET_KEY:6,UNKNOWN_OTP:7,INVALID_DIGITS:8,UNKNOWN_ALGORITHM:9};function n(e){this.name="OtpauthInvalidURL",this.message="Given otpauth:// URL is invalid. (Error "+e+")",this.errorType=e}n.prototype=new Error,n.prototype.constructor=n;const r=[6,8],i=["SHA1","SHA256","SHA512","MD5"];e.ErrorType=o,e.OtpauthInvalidURL=n,e.parse=function(e){const s={};let I;try{I=new t(e)}catch(e){throw e instanceof TypeError?new n(o.INVALID_PROTOCOL):e}if("otpauth:"!==I.protocol)throw new n(o.INVALID_PROTOCOL);I.protocol="http",I=new t(I);const h=decodeURIComponent(I.host);if("hotp"!==h&&"totp"!==h)throw new n(o.UNKNOWN_OTP);s.type=h;const p=I.pathname.substring(1),N=p.split(~p.indexOf(":")?":":"%3A");let a="",c="";if(1===N.length)c=decodeURIComponent(N[0]);else{if(2!==N.length)throw new n(o.INVALID_LABEL);a=decodeURIComponent(N[0]),c=decodeURIComponent(N[1])}if(c.length<1)throw new n(o.MISSING_ACCOUNT_NAME);if(2===N.length&&a.length<1)throw new n(o.INVALID_ISSUER);s.account=c;const f=I.searchParams;if(!f.has("secret"))throw new n(o.MISSING_SECRET_KEY);if(s.key=f.get("secret"),f.has("issuer")&&a&&f.get("issuer")!==a)throw new n(o.INVALID_ISSUER);if(s.issuer=a||f.get("issuer")||"",s.digits=6,f.has("digits")){const e=parseInt(f.get("digits"),10);if(-1==r.indexOf(e))throw new n(o.INVALID_DIGITS);s.digits=e}if(f.has("algorithm")){if(-1==i.indexOf(f.get("algorithm")))throw new n(o.UNKNOWN_ALGORITHM);s.algorithm=f.get("algorithm")}if("totp"===h&&f.has("period")&&(s.period=parseFloat(f.get("period"))),"hotp"===h){if(!f.has("counter"))throw new n(o.MISSING_COUNTER);s.counter=parseInt(f.get("counter"),10)}return s},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=url-otpauth-ng.min.js.map
