!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).urlOtpauthNg={})}(this,function(t){"use strict";const e=0,o=1,n=2,r=3,i=4,s=6,h=7,a=8,f=9;var p={INVALID_ISSUER:e,INVALID_LABEL:o,INVALID_PROTOCOL:n,MISSING_ACCOUNT_NAME:r,MISSING_COUNTER:i,MISSING_ISSUER:5,MISSING_SECRET_KEY:s,UNKNOWN_OTP:h,INVALID_DIGITS:a,UNKNOWN_ALGORITHM:f};class u extends Error{constructor(t){super(),this.name="OtpauthInvalidURL",this.errorType=t;for(const e in p)p[e]===t&&(this.message="Given otpauth:// URL is invalid. (Error "+e+")")}}const c="undefined"!=typeof URL?URL:require("url").URL,d=["totp","hotp","yaotp"],l=[6,8],I=["SHA1","SHA256","SHA512","MD5"];t.ErrorType=p,t.OtpauthInvalidURL=u,t.parse=function(t){const p=decodeURIComponent,g={};let w=new c(t);if("otpauth:"!==w.protocol)throw new u(n);w.protocol="ftp";const N=p((w=new c(w)).host);if(!~d.indexOf(N))throw new u(h);g.type=N;const O=w.pathname.substring(1),S=O.split(~O.indexOf(":")?":":"%3A");let L="",_="";if(1===S.length)_=p(S[0]);else{if(2!==S.length)throw new u(o);L=p(S[0]),_=p(S[1])}if(_.length<1)throw new u(r);if(2===S.length&&L.length<1)throw new u(e);g.account=_;const R=w.searchParams;if(!R.has("secret"))throw new u(s);if(g.key=R.get("secret"),R.has("issuer")&&L&&R.get("issuer")!==L)throw new u(e);if(g.issuer=R.get("issuer")||L,g.digits=6,R.has("digits")){const t=parseInt(R.get("digits"))||0;if(!~l.indexOf(t))throw new u(a);g.digits=t}if(R.has("algorithm")){if(!~I.indexOf(R.get("algorithm")))throw new u(f);g.algorithm=R.get("algorithm")}if("totp"===N&&R.has("period")&&(g.period=parseFloat(R.get("period"))||0),"hotp"===N){if(!R.has("counter"))throw new u(i);g.counter=parseInt(R.get("counter"))||0}return g},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=url-otpauth-ng.min.js.map
